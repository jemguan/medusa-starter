import{u as re,a as se,b as te}from"./chunk-NEZX6265-ZuwxZQi4.js";import{r as f,q as M,d as ie,g as ae,a as ne,j as s,dS as oe,ey as ce,ez as le,k as ue,l as de,eA as B,b as _,H,A as k,W as pe,ev as me,T as p,Y as ge,t as x}from"./index-DBWnS55e.js";import{S as fe}from"./chunk-ADOCJB6L-BybeEzAu.js";import{u as xe,_ as he}from"./chunk-GIYLQ7GZ-Dxzza7Al.js";import"./lodash-CkfAw9Ei.js";import"./chunk-RGGFF4GO-BDh_Ux-6.js";import"./chunk-BNLHRJ2A-B4VOBEOm.js";import"./chunk-KHOKHZC6-CqxQBDX6.js";import{S as ye}from"./chunk-2RQLKDBF-Bh7PNNZz.js";import{P as ve}from"./pencil-square-BGxxvtjf.js";import{X as _e}from"./x-circle-lZOAvs8T.js";import{T as je}from"./trash-BbCe7kO5.js";import{u as Y}from"./use-prompt-QBO7IBKf.js";import{C as K}from"./container-5t1z13_s.js";import{C as h}from"./command-bar-BfvDtHkO.js";import{C as W}from"./checkbox-Dx5Ec5yQ.js";import{c as Ce}from"./index-C6aG_rAm.js";import"./chunk-MSDRGCRR-D20aVZP0.js";import"./chunk-P3UUX2T6-OnzgsjCG.js";import"./chunk-C76H5USB-BMI9TpQ9.js";import"./chunk-YEDAFXMB-B4PnkAmC.js";import"./chunk-AOFGTNG6-Bq5N9j8X.js";import"./table-Cm0Q73Cc.js";import"./chunk-WX2SMNCD-BhhDqt1V.js";import"./plus-mini-BWMzFMSU.js";import"./chunk-EPATMX2O-BgfuWjsz.js";import"./format-DNy3JvIM.js";import"./_isIndex-DEiN0s9l.js";import"./x-mark-mini-6vGwjIi3.js";import"./date-picker-kwlXJTN2.js";import"./clsx-B-dksMZM.js";import"./popover-DBRdYr3T.js";import"./index-Doo_3Q1b.js";import"./triangle-left-mini-4LlIioCu.js";import"./Trans-B06GFbPO.js";import"./check-BVlAH3XP.js";import"./prompt-BFR56MoQ.js";var Se=Object.defineProperty,v=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Q=(e,r,t)=>r in e?Se(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,be=(e,r)=>{for(var t in r)G.call(r,t)&&Q(e,t,r[t]);if(v)for(var t of v(r))J.call(r,t)&&Q(e,t,r[t]);return e},we=(e,r)=>{var t={};for(var i in e)G.call(e,i)&&r.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&v)for(var i of v(e))r.indexOf(i)<0&&J.call(e,i)&&(t[i]=e[i]);return t};const U=f.forwardRef((e,r)=>{var t=e,{color:i="currentColor"}=t,o=we(t,["color"]);return f.createElement("svg",be({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},o),f.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 13.945a6.444 6.444 0 1 0 0-12.89 6.444 6.444 0 0 0 0 12.89"}),f.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m4.611 7.722 2 2.223 3.778-4.89"}))});U.displayName="CheckCircle";var Pe=()=>({queryKey:ce.details(),queryFn:async()=>le()}),gr=async()=>{const e=Pe();return M.getQueryData(e.queryKey)??await M.fetchQuery(e)},w=10,ke=({store:e})=>{var I,O,N,R,z,D,A,q;const[r,t]=f.useState({}),{searchParams:i,raw:o}=re({pageSize:w}),{currencies:c,count:a,isPending:m,isError:j,error:C}=se({code:(I=e.supported_currencies)==null?void 0:I.map(n=>n.currency_code),...i},{placeholderData:ue,enabled:!!((O=e.supported_currencies)!=null&&O.length)}),{price_preferences:g,isPending:y,isError:d,error:u}=de({attribute:"currency_code",value:(N=e.supported_currencies)==null?void 0:N.map(n=>n.currency_code)},{enabled:!!((R=e.supported_currencies)!=null&&R.length)}),T=Ee(),E=f.useMemo(()=>new Map(g==null?void 0:g.map(n=>[n.value,n])),[g]),V=c==null?void 0:c.map(n=>{var S;return{...n,is_tax_inclusive:(S=E.get(n.code))==null?void 0:S.is_tax_inclusive}}),{table:X}=xe({data:V??[],columns:T,count:a,getRowId:n=>n.code,rowSelection:{state:r,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:w,meta:{storeId:e.id,supportedCurrencies:e.supported_currencies,defaultCurrencyCode:(D=(z=e.supported_currencies)==null?void 0:z.find(n=>n.is_default))==null?void 0:D.currency_code,preferencesMap:E}}),{mutateAsync:F}=B(e.id),{t:l}=_(),Z=Y(),$=async()=>{var L;const n=Object.keys(r);await Z({title:l("general.areYouSure"),description:l("store.removeCurrencyWarning",{count:n.length}),confirmText:l("actions.remove"),cancelText:l("actions.cancel")})&&await F({supported_currencies:((L=e.supported_currencies)==null?void 0:L.filter(b=>!n.includes(b.currency_code)))??[]},{onSuccess:()=>{t({}),x.success(l("store.toast.currenciesRemoved"))},onError:b=>{x.error(b.message)}})};if(j)throw C;if(d)throw u;const ee=m||y;return s.jsxs(K,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(H,{level:"h2",children:l("store.currencies")}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(pe,{}),label:l("actions.add"),to:"currencies"}]}]})]}),s.jsx(he,{orderBy:[{key:"name",label:l("fields.name")},{key:"code",label:l("fields.code")}],search:!0,pagination:!0,table:X,pageSize:w,columns:T,count:(A=e.supported_currencies)!=null&&A.length?a:0,isLoading:(q=e.supported_currencies)!=null&&q.length?ee:!1,queryObject:o}),s.jsx(h,{open:!!Object.keys(r).length,children:s.jsxs(h.Bar,{children:[s.jsx(h.Value,{children:l("general.countSelected",{count:Object.keys(r).length})}),s.jsx(h.Seperator,{}),s.jsx(h.Command,{action:$,shortcut:"r",label:l("actions.remove")})]})})]})},Te=({storeId:e,currency:r,supportedCurrencies:t,defaultCurrencyCode:i,preferencesMap:o})=>{var g,y;const{mutateAsync:c}=B(e),{t:a}=_(),m=Y(),j=async()=>{await m({title:a("general.areYouSure"),description:a("store.removeCurrencyWarning",{count:1}),verificationInstruction:a("general.typeToConfirm"),verificationText:r.name,confirmText:a("actions.remove"),cancelText:a("actions.cancel")})&&await c({supported_currencies:t.filter(u=>u.currency_code!==r.code)},{onSuccess:()=>{x.success(a("store.toast.currenciesRemoved"))},onError:u=>{x.error(u.message)}})},C=async()=>{await c({supported_currencies:t.map(d=>{const u=o.get(d.currency_code);return{...d,is_tax_inclusive:d.currency_code===r.code?!(u!=null&&u.is_tax_inclusive):void 0}})},{onSuccess:()=>{x.success(a("store.toast.updatedTaxInclusivitySuccessfully"))},onError:d=>{x.error(d.message)}})};return s.jsx(k,{groups:[{actions:[{icon:(g=o.get(r.code))!=null&&g.is_tax_inclusive?s.jsx(_e,{}):s.jsx(U,{}),label:(y=o.get(r.code))!=null&&y.is_tax_inclusive?a("store.disableTaxInclusivePricing"):a("store.enableTaxInclusivePricing"),onClick:C}]},{actions:[{icon:s.jsx(je,{}),label:a("actions.remove"),onClick:j,disabled:r.code===i}]}]})},P=Ce(),Ee=()=>{const e=te(),{t:r}=_();return f.useMemo(()=>[P.display({id:"select",header:({table:t})=>s.jsx(W,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:i=>t.toggleAllPageRowsSelected(!!i)}),cell:({row:t})=>s.jsx(W,{checked:t.getIsSelected(),onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}})}),...e,P.accessor("is_tax_inclusive",{header:r("fields.taxInclusivePricing"),cell:({getValue:t})=>{const i=t();return s.jsx(fe,{color:i?"green":"grey",children:r(i?"fields.true":"fields.false")})}}),P.display({id:"actions",cell:({row:t,table:i})=>{const{supportedCurrencies:o,storeId:c,defaultCurrencyCode:a,preferencesMap:m}=i.options.meta;return s.jsx(Te,{storeId:c,currency:t.original,supportedCurrencies:o,defaultCurrencyCode:a,preferencesMap:m})}})],[e,r])},Ie=({store:e})=>{var o,c,a;const{t:r}=_(),{region:t}=me(e.default_region_id,void 0,{enabled:!!e.default_region_id}),i=(o=e.supported_currencies)==null?void 0:o.find(m=>m.is_default);return s.jsxs(K,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(H,{children:r("store.domain")}),s.jsx(p,{className:"text-ui-fg-subtle",size:"small",children:r("store.manageYourStoresDetails")})]}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(ve,{}),label:r("actions.edit"),to:"edit"}]}]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:r("fields.name")}),s.jsx(p,{size:"small",leading:"compact",children:e.name})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultCurrency")}),i?s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(ge,{size:"2xsmall",children:(c=i.currency_code)==null?void 0:c.toUpperCase()}),s.jsx(p,{size:"small",leading:"compact",children:(a=i.currency)==null?void 0:a.name})]}):s.jsx(p,{size:"small",leading:"compact",children:"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultRegion")}),s.jsx("div",{className:"flex items-center gap-x-2",children:s.jsx(p,{size:"small",leading:"compact",children:(t==null?void 0:t.name)||"-"})})]})]})},fr=()=>{const e=ie(),{store:r,isPending:t,isError:i,error:o}=ae(void 0,{initialData:e}),{getWidgets:c}=ne();if(t||!r)return s.jsx(oe,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw o;return s.jsxs(ye,{widgets:{before:c("store.details.before"),after:c("store.details.after")},data:r,hasOutlet:!0,showMetadata:!0,showJSON:!0,children:[s.jsx(Ie,{store:r}),s.jsx(ke,{store:r})]})};export{fr as Component,gr as loader};
