import{u as z,a as D,b as I}from"./chunk-VELNOPU6-H-EMcak3.js";import{a1 as B,ad as M,a3 as H,R as L,Q as N,j as s,b as O,a8 as Q,a9 as U,r as d,J as V,U as q,B as f,k as G}from"./index-BZ3ouZyT.js";import{u as J,_ as Z}from"./chunk-GIYLQ7GZ-COPz3VHk.js";import"./lodash-ER-XXxsc.js";import"./chunk-RGGFF4GO-De8iqvE2.js";import"./chunk-BNLHRJ2A-Cgc_KhUv.js";import"./chunk-KHOKHZC6-DT8VDB1S.js";import{R as r,u as $}from"./chunk-6DAFMWMA-DzrLSfpZ.js";import{C as g}from"./checkbox-B5K-oibM.js";import{c as K}from"./index-Dd6kzxGa.js";import"./chunk-GA34GXNI-BQZC5d02.js";import"./chunk-P3UUX2T6-Bfdkflac.js";import"./chunk-MSDRGCRR-CD8LH72i.js";import"./chunk-ADOCJB6L-BF9tvjhY.js";import"./chunk-C76H5USB-DJmIyDuL.js";import"./chunk-YEDAFXMB-vEHoKu6I.js";import"./chunk-AOFGTNG6-_e2_Aola.js";import"./table-DKxkjXzR.js";import"./chunk-WX2SMNCD-Bdui9F_i.js";import"./plus-mini-DC6oI0AW.js";import"./command-bar-D0N15Guc.js";import"./index-Bs-HA-OK.js";import"./chunk-EPATMX2O-BiMkhVyz.js";import"./format-CdPIKOEK.js";import"./_isIndex-D8Z7wicQ.js";import"./x-mark-mini-BwnMkSg-.js";import"./date-picker-B2GVDlSJ.js";import"./clsx-B-dksMZM.js";import"./popover-BYvWdU6Y.js";import"./triangle-left-mini-DKSLhgY_.js";import"./prompt-D55FtKXi.js";var W=B({sales_channels:M(H()).optional()}),c=50,X=({product:o})=>{var p,h;const{t:e}=O(),{handleSuccess:t}=$(),l=Q({defaultValues:{sales_channels:((p=o.sales_channels)==null?void 0:p.map(a=>a.id))??[]},resolver:U(W)}),{setValue:n}=l,x=((h=o.sales_channels)==null?void 0:h.reduce((a,S)=>(a[S.id]=!0,a),{}))??{},[i,C]=d.useState(x);d.useEffect(()=>{const a=Object.keys(i);n("sales_channels",a,{shouldDirty:!0,shouldTouch:!0})},[i,n]);const{searchParams:j,raw:y}=z({pageSize:c}),{sales_channels:b,count:u,isLoading:v,isError:_,error:k}=V({...j},{placeholderData:G}),w=D(),m=ee(),{table:P}=J({data:b??[],columns:m,count:u,enablePagination:!0,enableRowSelection:!0,rowSelection:{state:i,updater:C},getRowId:a=>a.id,pageSize:c}),{mutateAsync:R,isPending:T}=q(o.id),E=l.handleSubmit(async a=>{const A=(a.sales_channels??[]).map(F=>({id:F}));await R({sales_channels:A},{onSuccess:()=>{t()}})});if(_)throw k;return s.jsx(r.Form,{form:l,children:s.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[s.jsx(r.Header,{}),s.jsx(r.Body,{className:"flex-1 overflow-hidden",children:s.jsx(Z,{table:P,columns:m,pageSize:c,isLoading:v,count:u,filters:w,search:"autofocus",pagination:!0,orderBy:[{key:"name",label:e("fields.name")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],queryObject:y,layout:"fill"})}),s.jsx(r.Footer,{children:s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsx(r.Close,{asChild:!0,children:s.jsx(f,{size:"small",variant:"secondary",children:e("actions.cancel")})}),s.jsx(f,{size:"small",isLoading:T,onClick:E,children:e("actions.save")})]})})]})})},Y=K(),ee=()=>{const o=I();return d.useMemo(()=>[Y.display({id:"select",header:({table:e})=>s.jsx(g,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t)}),cell:({row:e})=>s.jsx(g,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...o],[o])},Fe=()=>{const{id:o}=L(),{product:e,isLoading:t,isError:l,error:n}=N(o);if(l)throw n;return s.jsx(r,{children:!t&&e&&s.jsx(X,{product:e})})};export{Fe as Component};
